import{c as Aa,a as T,f as k,t as Fe}from"../chunks/CHkKYhNx.js";import{i as Ia}from"../chunks/DYBLop6c.js";import{o as Xe,d as Ta,w as de}from"../chunks/BD_s1Hae.js";import{B as Ne,h as Y,a5 as za,ae as Va,x as Pa,b as Ea,k as s,O as Qe,y as ka,z as Ba,A as We,C as Re,c as ye,a8 as Na,D as Ze,a as je,F as Ra,ac as $e,a3 as Da,J as L,ap as qe,aq as De,a1 as Ge,ar as Oa,as as La,at as Ha,ab as Fa,au as Wa,d as qa,av as Ga,aw as Ya,a6 as Ja,L as Ka,G as Ua,p as ea,K as u,am as Xa,f as aa,q as ta,v as m,t as le,ax as pe,ay as Qa,s as M,az as Ye,w as E,i as Za}from"../chunks/Dki7Y-0p.js";import{e as ue,s as U}from"../chunks/BtQVrNRb.js";import{p as I,i as H,s as ja,a as se}from"../chunks/CDNwQorJ.js";function $a(t,e){return e}function et(t,e,a,n){for(var d=[],r=e.length,i=0;i<r;i++)Ha(e[i].e,d,!0);var c=r>0&&d.length===0&&a!==null;if(c){var w=a.parentNode;Fa(w),w.append(a),n.clear(),ee(t,e[0].prev,e[r-1].next)}Wa(d,()=>{for(var p=0;p<r;p++){var o=e[p];c||(n.delete(o.k),ee(t,o.prev,o.next)),qa(o.e,!c)}})}function at(t,e,a,n,d,r=null){var i=t,c={flags:e,items:new Map,first:null};{var w=t;i=Y?Ne(za(w)):w.appendChild(Va())}Y&&Pa();var p=null,o=!1,A=Qe(()=>{var f=a();return Da(f)?f:f==null?[]:$e(f)});Ea(()=>{var f=s(A),h=f.length;if(o&&h===0)return;o=h===0;let _=!1;if(Y){var z=ka(i)===Ba;z!==(h===0)&&(i=We(),Ne(i),Re(!1),_=!0)}if(Y){for(var F=null,b,x=0;x<h;x++){if(ye.nodeType===8&&ye.data===Na){i=ye,_=!0,Re(!1);break}var D=f[x],g=n(D,x);b=na(ye,c,F,null,D,g,x,d,e,a),c.items.set(g,b),F=b}h>0&&Ne(We())}Y||tt(f,c,i,d,e,n,a),r!==null&&(h===0?p?Ze(p):p=je(()=>r(i)):p!==null&&Ra(p,()=>{p=null})),_&&Re(!0),s(A)}),Y&&(i=ye)}function tt(t,e,a,n,d,r,i){var c=t.length,w=e.items,p=e.first,o=p,A,f=null,h=[],_=[],z,F,b,x;for(x=0;x<c;x+=1){if(z=t[x],F=r(z,x),b=w.get(F),b===void 0){var D=o?o.e.nodes_start:a;f=na(D,e,f,f===null?e.first:f.next,z,F,x,n,d,i),w.set(F,f),h=[],_=[],o=f.next;continue}if(nt(b,z,x),(b.e.f&De)!==0&&Ze(b.e),b!==o){if(A!==void 0&&A.has(b)){if(h.length<_.length){var g=_[0],B;f=g.prev;var J=h[0],K=h[h.length-1];for(B=0;B<h.length;B+=1)Je(h[B],g,a);for(B=0;B<_.length;B+=1)A.delete(_[B]);ee(e,J.prev,K.next),ee(e,f,J),ee(e,K,g),o=g,f=K,x-=1,h=[],_=[]}else A.delete(b),Je(b,o,a),ee(e,b.prev,b.next),ee(e,b,f===null?e.first:f.next),ee(e,f,b),f=b;continue}for(h=[],_=[];o!==null&&o.k!==F;)(o.e.f&De)===0&&(A??(A=new Set)).add(o),_.push(o),o=o.next;if(o===null)continue;b=o}h.push(b),f=b,o=b.next}if(o!==null||A!==void 0){for(var ae=A===void 0?[]:$e(A);o!==null;)(o.e.f&De)===0&&ae.push(o),o=o.next;var N=ae.length;if(N>0){var V=c===0?a:null;et(e,ae,V,w)}}Ge.first=e.first&&e.first.e,Ge.last=f&&f.e}function nt(t,e,a,n){La(t.v,e),t.i=a}function na(t,e,a,n,d,r,i,c,w,p){var o=(w&Ga)!==0,A=(w&Ya)===0,f=o?A?L(d,!1,!1):qe(d):d,h=(w&Oa)===0?i:qe(i),_={i:h,v:f,k:r,a:null,e:null,prev:a,next:n};try{return _.e=je(()=>c(t,f,h,p),Y),_.e.prev=a&&a.e,_.e.next=n&&n.e,a===null?e.first=_:(a.next=_,a.e.next=_.e),n!==null&&(n.prev=_,n.e.prev=_.e),_}finally{}}function Je(t,e,a){for(var n=t.next?t.next.e.nodes_start:a,d=e?e.e.nodes_start:a,r=t.e.nodes_start;r!==n;){var i=Ja(r);d.before(r),r=i}}function ee(t,e,a){e===null?t.first=a:(e.next=a,e.e.next=a&&a.e),a!==null&&(a.prev=e,a.e.prev=e&&e.e)}const Ke=[...` 	
\r\f \v\uFEFF`];function st(t,e,a){var n=t==null?"":""+t;if(e&&(n=n?n+" "+e:e),a){for(var d in a)if(a[d])n=n?n+" "+d:d;else if(n.length)for(var r=d.length,i=0;(i=n.indexOf(d,i))>=0;){var c=i+r;(i===0||Ke.includes(n[i-1]))&&(c===n.length||Ke.includes(n[c]))?n=(i===0?"":n.substring(0,i))+n.substring(c+1):i=c}}return n===""?null:n}function lt(t,e){return t==null?null:String(t)}function xe(t,e,a,n,d,r){var i=t.__className;if(Y||i!==a||i===void 0){var c=st(a,n,r);(!Y||c!==t.getAttribute("class"))&&(c==null?t.removeAttribute("class"):e?t.className=c:t.setAttribute("class",c)),t.__className=a}else if(r&&d!==r)for(var w in r){var p=!!r[w];(d==null||p!==!!d[w])&&t.classList.toggle(w,p)}return r}function Ue(t,e,a,n){var d=t.__style;if(Y||d!==e){var r=lt(e);(!Y||r!==t.getAttribute("style"))&&(r==null?t.removeAttribute("style"):t.style.cssText=r),t.__style=e}return n}function Me(t,e,a){var n=Ka(t,e);n&&n.set&&(t[e]=a,Ua(()=>{t[e]=null}))}var it=k('<div class="confetti svelte-15ksp55"></div>'),rt=k("<div></div>");function ot(t,e){ea(e,!0);const a=I(e,"size",3,10),n=I(e,"x",19,()=>[-.5,.5]),d=I(e,"y",19,()=>[.25,1]),r=I(e,"duration",3,2e3),i=I(e,"infinite",3,!1),c=I(e,"delay",19,()=>[0,50]),w=I(e,"colorRange",19,()=>[0,360]),p=I(e,"colorArray",19,()=>[]),o=I(e,"amount",3,50),A=I(e,"iterationCount",3,1),f=I(e,"fallDistance",3,"100px"),h=I(e,"rounded",3,!1),_=I(e,"cone",3,!1),z=I(e,"noGravity",3,!1),F=I(e,"xSpread",3,.15),b=I(e,"destroyOnComplete",3,!0),x=I(e,"disableForReducedMotion",3,!1);let D=Xa(!1);Xe(()=>{!b()||i()||typeof A()=="string"||setTimeout(()=>u(D,!0),(r()+c()[1])*A())});function g(N,V){return Math.random()*(V-N)+N}function B(){return p().length?p()[Math.round(Math.random()*(p().length-1))]:`hsl(${Math.round(g(w()[0],w()[1]))}, 75%, 50%)`}var J=Aa(),K=aa(J);{var ae=N=>{var V=rt();let ge;at(V,21,()=>({length:o()}),$a,(Q,ie)=>{var O=it();le((W,q,ce,X,re,Ce,Se,he,_e,me,we)=>Ue(O,`
        --color: ${W??""};
        --skew: ${q??""}deg,${ce??""}deg;
        --rotation-xyz: ${X??""}, ${re??""}, ${Ce??""};
        --rotation-deg: ${Se??""}deg;
        --translate-y-multiplier: ${he??""};
        --translate-x-multiplier: ${_e??""};
        --scale: ${me??""};
        --transition-delay: ${we??""}ms;
        --transition-duration: ${i()?`calc(${r()}ms * var(--scale))`:`${r()}ms`};`),[B,()=>g(-45,45),()=>g(-45,45),()=>g(-10,10),()=>g(-10,10),()=>g(-10,10),()=>g(0,360),()=>g(d()[0],d()[1]),()=>g(n()[0],n()[1]),()=>.1*g(2,10),()=>g(c()[0],c()[1])]),T(Q,O)}),m(V),le(Q=>{ge=xe(V,1,"confetti-holder svelte-15ksp55",null,ge,Q),Ue(V,`
    --fall-distance: ${f()??""};
    --size: ${a()??""}px;
    --x-spread: ${1-F()};
    --transition-iteration-count: ${(i()?"infinite":A())??""};`)},[()=>({rounded:h(),cone:_(),"no-gravity":z(),"reduced-motion":x()})]),T(N,V)};H(K,N=>{s(D)||N(ae)})}T(t,J),ta()}var vt=k('<p style="font-size: 14px;" class="svelte-n7hff6"> <br class="svelte-n7hff6"/> </p>'),ft=k('<button class="reconnect svelte-n7hff6">Reconnect</button>'),dt=k('<button class="btn connect svelte-n7hff6">Connect</button>'),ut=k('<button class="btn disabled svelte-n7hff6"><span class="spinner svelte-n7hff6"></span>&nbsp;Connecting</button>'),ct=k('<span class="spinner spinner-sm svelte-n7hff6"></span>'),ht=k('<img class="download-icon svelte-n7hff6" src="/download-icon.png" alt="Download"/>'),_t=k('<div class="meta-line svelte-n7hff6"><div class="vault-icon svelte-n7hff6"><div class="bar bar-1a svelte-n7hff6"></div><div class="bar bar-2a svelte-n7hff6"></div><div class="bar bar-3a svelte-n7hff6"></div></div> <span class="meta svelte-n7hff6"> </span> <button><!></button></div>'),bt=k('<div class="meta-line svelte-n7hff6"><div class="vault-icon svelte-n7hff6"><div class="bar bar-1b svelte-n7hff6"></div> <div class="bar bar-2b svelte-n7hff6"></div> <div class="bar bar-3b svelte-n7hff6"></div></div> <span style="margin-top:-5px;" class="meta svelte-n7hff6"> </span></div> <button class="reconnect svelte-n7hff6">Reconnect</button>',1),yt=k('<button class="btn connect svelte-n7hff6">Connect</button>'),pt=k('<button class="btn disabled svelte-n7hff6"><span class="spinner svelte-n7hff6"></span>&nbsp;Connecting...</button>'),gt=k('<div class="meta-line svelte-n7hff6"><div class="vault-icon svelte-n7hff6"><div class="bar bar-1b svelte-n7hff6"></div> <div class="bar bar-2b svelte-n7hff6"></div> <div class="bar bar-3b svelte-n7hff6"></div></div> <span style="margin-top:-5px;" class="meta svelte-n7hff6"> </span></div>'),mt=k('<span class="spinner svelte-n7hff6"></span>&nbsp;Syncing',1),wt=k('<div style="margin-top:-70px" class="svelte-n7hff6"><!></div>'),Mt=k('<div class="wrapper svelte-n7hff6"><div class="topbar svelte-n7hff6"><div class="topbar-left svelte-n7hff6"><button class="dropdown-toggle svelte-n7hff6"><svg width="20" height="20" viewBox="0 0 24 24"><line x1="5" y1="7" x2="20" y2="7" class="svelte-n7hff6"></line><line x1="5" y1="16" x2="20" y2="16" class="svelte-n7hff6"></line></svg></button></div> <div class="topbar-title svelte-n7hff6"><div class="title svelte-n7hff6">Vault<span class="gray svelte-n7hff6">Sync</span><span class="tm svelte-n7hff6">TM</span></div></div> <div class="topbar-right svelte-n7hff6"><button class="login svelte-n7hff6" disabled>Log In</button></div></div> <div class="vaults svelte-n7hff6"><div class="vault svelte-n7hff6"><h2 class="svelte-n7hff6"> </h2> <p style="font-size: 14px" class="svelte-n7hff6"> </p> <!> <!></div> <div class="vault svelte-n7hff6"><h2 class="svelte-n7hff6"> </h2> <p style="font-size: 14px" class="svelte-n7hff6"> </p> <!></div></div> <div class="sync-area svelte-n7hff6"><button><!></button> <p class="sub svelte-n7hff6"> </p></div> <!></div>');function zt(t,e){ea(e,!1);const[a,n]=ja(),d=()=>se(V,"$mediaSizeMB",a),r=()=>se(ie,"$vault2Closed",a),i=()=>se(N,"$mediaCount",a),c=()=>se(Q,"$vault1Closed",a),w=()=>se(ge,"$noMedia",a),p=()=>se(J,"$vault2MediaCount",a),o=()=>se(K,"$vault2MediaSizeMB",a),A=L(),f=L(),h=L(),_=L();let z={},F=I(e,"vault1Name",12,"Vault 1"),b=I(e,"vault2Name",12,"Vault 2"),x=L(""),D=L(""),g=L(""),B=L("");const J=de(0),K=de(0);let ae=!1;const N=de(0),V=de(0),ge=Ta([N,V],([l,v])=>l===0&&v===0),Q=de(!1),ie=de(!1);Xe(async()=>{var v,C,R,y,S,ve,Z,P;z=await(await fetch("/vaultVars.json")).json(),F(`${z.vaultOneVars} Vault`),b(`${z.vaultTwoVars} Vault`),u(x,`Link your ${z.vaultOneVars} Vault~`),u(D,`Link your ${z.vaultTwoVars} Vault~`),(C=(v=window.vaultsyncAPI)==null?void 0:v.onMediaSummary)==null||C.call(v,({count:G,sizeMB:j})=>{N.set(G),V.set(j)}),(y=(R=window.vaultsyncAPI)==null?void 0:R.onPopupWindowStatus)==null||y.call(R,({vault:G,status:j})=>{G===1&&j==="closed"&&Q.set(!0),G===2&&j==="closed"&&(ie.set(!0),u(W,"idle"))}),(ve=(S=window.vaultsyncAPI)==null?void 0:S.onVault2LoginSuccess)==null||ve.call(S,()=>{u(W,"done"),u(D,"Connected to Slushy"),r()&&u(D,""),ie.set(!1)}),(P=(Z=window.vaultsyncAPI)==null?void 0:Z.onPopupWindow2Closed)==null||P.call(Z,()=>{ie.set(!0)})});let O=L("idle"),W=L("idle"),q=L("idle"),ce=L(!1),X=L("idle");function re(l){var v,C;l===1&&(s(O)!=="idle"&&u(O,"idle"),s(O)==="idle"&&(u(O,"loading"),u(x,"Securing access…"),u(g,""),u(B,""),Q.set(!1),(C=(v=window.vaultsyncAPI)==null?void 0:v.openNewWindow)==null||C.call(v,`https://${z.vaultOneVars}.com/my/vault/list/all`),setTimeout(()=>{s(O)==="loading"&&(u(O,"done"),u(x,""),u(g,`Preview and play content in ${z.vaultOneShort}`),u(B,"to choose what syncs")),Q.set(!1)},1800))),l===2&&(s(W)!=="idle"&&u(W,"idle"),s(W)==="idle"&&(u(W,"loading"),u(D,"Securing access..."),ie.set(!1),window.vaultsyncAPI.openPopupWindow2()))}async function Ce(){if(!s(h)){u(q,"loading");try{const l=await window.vaultsyncAPI.uploadMedia();if(!l.folderPath)throw new Error("No folderPath returned from uploadMedia");const v=await window.vaultsyncAPI.uploadMediaFiles(l.folderPath);u(q,"done"),u(ce,!0),setTimeout(()=>u(ce,!1),2100),J.set(i()),K.set(d())}catch(l){console.error("❌ Sync error:",l),u(q,"error")}}}async function Se(){var l;if((l=window.vaultsyncAPI)!=null&&l.downloadMedia){u(X,"loading");try{const v=await window.vaultsyncAPI.downloadMedia();N.set(v.count),V.set(v.sizeMB),u(X,"done")}catch{u(X,"idle")}setTimeout(()=>u(X,"idle"),2500)}}pe(()=>d(),()=>{u(A,d()?d():0)}),pe(()=>r(),()=>{r()&&u(D,"")}),pe(()=>(s(O),s(W)),()=>{u(f,s(O)==="done"&&s(W)==="done")}),pe(()=>(s(f),s(q)),()=>{u(h,!s(f)||s(q)!=="idle")}),pe(()=>(s(q),s(f)),()=>{u(_,s(q)==="done"?"Sync complete. Everything’s in harmony.":s(f)?"Your vaults are linked. Tap Sync when you’re ready.":"Connect both vaults to unlock Sync.")}),Qa(),Ia();var he=Mt(),_e=M(he),me=M(_e),we=M(me),sa=M(we);xe(sa,0,"svelte-n7hff6",null,{},{open:ae}),m(we),m(me),Ye(4),m(_e);var Ae=E(_e,2),Ie=M(Ae),Te=M(Ie),la=M(Te,!0);m(Te);var ze=E(Te,2),ia=M(ze,!0);m(ze);var Oe=E(ze,2);{var ra=l=>{var v=vt(),C=M(v,!0),R=E(C,2,!0);m(v),le(()=>{U(C,s(g)),U(R,s(B))}),T(l,v)};H(Oe,l=>{s(g)&&s(B)&&l(ra)})}var oa=E(Oe,2);{var va=l=>{var v=ft();ue("click",v,()=>re(1)),T(l,v)},fa=(l,v)=>{{var C=y=>{var S=dt();ue("click",S,()=>re(1)),T(y,S)},R=(y,S)=>{{var ve=P=>{var G=ut();T(P,G)},Z=(P,G)=>{{var j=te=>{var ne=_t(),fe=E(M(ne),2),ke=M(fe);m(fe);var be=E(fe,2),xa=M(be);{var Ca=$=>{var Be=ct();T($,Be)},Sa=$=>{var Be=ht();T($,Be)};H(xa,$=>{s(X)==="loading"?$(Ca):$(Sa,!1)})}m(be),m(ne),le($=>{U(ke,`${$??""} items fetched · ${d()??""} MB`),xe(be,1,`downloadbtn ${s(X)==="loading"?"loading":""} ${w()?"disabled":""}`,"svelte-n7hff6"),be.disabled=s(X)==="loading"||w()},[()=>(i(),Za(()=>Math.max(0,i()<2?0:i()-3)))],Qe),ue("click",be,Se),T(te,ne)};H(P,te=>{s(O)==="done"&&te(j)},G)}};H(y,P=>{s(O)==="loading"?P(ve):P(Z,!1)},S)}};H(l,y=>{s(O)==="idle"?y(C):y(R,!1)},v)}};H(oa,l=>{c()?l(va):l(fa,!1)})}m(Ie);var Le=E(Ie,2),Ve=M(Le),da=M(Ve,!0);m(Ve);var Pe=E(Ve,2),ua=M(Pe,!0);m(Pe);var ca=E(Pe,2);{var ha=l=>{var v=bt(),C=aa(v),R=E(M(C),2),y=M(R);m(R),m(C);var S=E(C,2);le(()=>U(y,`${p()??""} items added · ${o()??""} MB`)),ue("click",S,()=>re(2)),T(l,v)},_a=(l,v)=>{{var C=y=>{var S=yt();ue("click",S,()=>re(2)),T(y,S)},R=(y,S)=>{{var ve=P=>{var G=pt();T(P,G)},Z=(P,G)=>{{var j=te=>{var ne=gt(),fe=E(M(ne),2),ke=M(fe);m(fe),m(ne),le(()=>U(ke,`${p()??""} items added · ${o()??""} MB`)),T(te,ne)};H(P,te=>{s(W)==="done"&&te(j)},G)}};H(y,P=>{s(W)==="loading"?P(ve):P(Z,!1)},S)}};H(l,y=>{s(W)==="idle"?y(C):y(R,!1)},v)}};H(ca,l=>{r()?l(ha):l(_a,!1)})}m(Le),m(Ae);var Ee=E(Ae,2),oe=M(Ee),ba=M(oe);{var ya=l=>{var v=mt();Ye(),T(l,v)},pa=(l,v)=>{{var C=y=>{var S=Fe(" Synced");T(y,S)},R=y=>{var S=Fe("Sync");T(y,S)};H(l,y=>{s(q)==="done"?y(C):y(R,!1)},v)}};H(ba,l=>{s(q)==="loading"?l(ya):l(pa,!1)})}m(oe);var He=E(oe,2),ga=M(He,!0);m(He),m(Ee);var ma=E(Ee,2);{var wa=l=>{var v=wt(),C=M(v);ot(C,{numberOfPieces:420,recycle:!1,options:{origin:{x:.5,y:.5},spread:70,decay:.46,ticks:100,gravity:1.4}}),m(v),T(l,v)};H(ma,l=>{s(ce)&&l(wa)})}m(he),le(()=>{U(la,F()),U(ia,s(x)),U(da,b()),U(ua,s(D)),xe(oe,1,`btn sync ${s(q)==="done"?"success":""} ${s(h)?"disabled":""}`,"svelte-n7hff6"),oe.disabled=s(h),U(ga,s(_))}),ue("click",oe,Ce),T(t,he),Me(e,"vault2MediaCount",J),Me(e,"vault2MediaSizeMB",K),Me(e,"mediaCount",N),Me(e,"mediaSizeMB",V);var Ma=ta({vault2MediaCount:J,vault2MediaSizeMB:K,mediaCount:N,mediaSizeMB:V});return n(),Ma}export{zt as component};
